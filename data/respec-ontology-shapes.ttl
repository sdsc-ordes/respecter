@prefix ex:   <http://example.org/#> .
@prefix sdc:  <https://swissdatacustodian.ch/doc/ontology#> .
@prefix dpv:  <https://w3id.org/dpv#> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix :     <http://www.myprefix.org/id/> .
@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sh:   <http://www.w3.org/ns/shacl#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sdc:  <https://swissdatacustodian.ch/doc/ontology#> .
@prefix shsh: <http://www.w3.org/ns/shacl-shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix vann: <http://purl.org/vocab/vann/> .
@prefix dct:  <http://purl.org/dc/terms/> .


<https://swissdatacustodian.ch/doc/ontology#> a owl:Ontology ;
    dct:abstract "The swiss data custodian ontology provides SHACL shapes and concepts (classes and properties) to model human and machine readable contracts."@en ;
    dct:contributor "Robin Franken", "Martin Fontanet", "Sabine Maennel", "Laure Vancauwenberghe", "Sabrina Ossey", "Cyril Matthey-Doret", "Stefan Milosavljevic" , "Luana Martelli", "Carlos Vivar Rios" ;
    dct:created "2023-10-16"^^xsd:date ;
    dct:creator "Robin Franken", "Martin Fontanet", "Sabrina Ossey" ;
    dct:description "The swiss data custodian ontology provides SHACL shapes and concepts (classes and properties) to model human and machine readable contracts."@en ;
    dct:license <https://spdx.org/licenses/CC-BY-SA-4.0.html> ;
    dct:modified "2024-01-17"^^xsd:date ;
    dct:title "Swiss Data Custodian Contract Ontology"@en ;
    vann:preferredNamespacePrefix "sdc" ;
    vann:preferredNamespaceUri "https://w3id.org/sdc#"^^xsd:string ;
    owl:versionInfo "1"^^xsd:string 
.

#Below is the shape for a container contract, it outlines which properties we expect for a container contract
#and how those properties should be filled in.


sdc:ContractShape
    rdf:type sh:NodeShape ;
    skos:prefLabel "Contract" ;
    sh:targetClass dpv:Contract ;
    sh:property sdc:hasIdentifierShape,
                sdc:startDateShape,
                sdc:endDateShape,
                sdc:hasDataHandlingShape.

sdc:DataHandlingShape
    rdf:type sh:NodeShape ;
    sh:targetClass sdc:DataHandling ;
    skos:prefLabel "Data Handling" ;
    sh:property sdc:hasDataControllerShape,
                sdc:hasDataSubjectShape,
                sdc:hasDataProcessorShape,
                sdc:hasPersonalDataShape,
                sdc:hasPurposeShape,
                sdc:hasProcessingShape,
                sdc:hasTechnicalOrganisationalMeasureShape.

sdc:PersonalData a rdfs:Class, sh:NodeShape ;
    sh:property sdc:downloadURLShape,
                sdc:themeShape ;
                .    
sdc:LegalEntityShape a sh:NodeShape ;
    sh:targetClass dpv:LegalEntity ;
    sh:property sdc:nameShape ,
                sdc:identifierShape ;
.

###################################################################################################################

dpv:Contract a rdfs:Class ;
    skos:definition "Creation, completion, fulfilment, or performance of a contract involving specified processing"@en ;
    skos:prefLabel "Contract"@en ;
    .

sdc:DataHandling a rdfs:Class ;
    skos:definition "A high-level Class to describe 'data handling'. This can consist of personal data being processed for a purpose, involving entities, using technical and organisational measures, applicable risks, rights, and legal basis."@en ;
    skos:prefLabel "Data Handling"
    .

dpv:LegalEntity a rdfs:Class ;
    rdfs:subClassOf dpv:Entity ;
    skos:prefLabel "Legal Entity" 
    .

dpv:NaturalPerson a rdfs:Class;
    rdfs:subClassOf dpv:Entity ;
    skos:prefLabel "Natural Person" 
.

dpv:OrganisationalUnit a rdfs:Class ;
    rdfs:subClassOf dpv:Entity ;
    skos:prefLabel "Organisational Unit" . 

############################################################################################################
dpv:hasIdentifier a rdf:Property ;
    skos:prefLabel "has identifier"@en ;
    skos:definition "Indicates an identifier associated for identification or reference"@en ;
    .

dcat:startDate a rdf:Property ;
    skos:prefLabel "Start date" ;
    skos:definition "The start of the period."
    .

dcat:endDate a rdf:Property ;
    skos:prefLabel "End date" ;
    skos:definition "The end of the period."
    .

dpv:hasDataController a rdf:Property ;    
    skos:prefLabel "has data controller" ;
    skos:definition "Indicates association with Data Controller" ;
    .

dpv:hasDataSubject a rdf:Property ;    
    skos:prefLabel "has data subject" ; 
    skos:definition "Indicates association with Data Subject" ;
    .

dpv:hasDataProcessor a rdf:Property ;    
    skos:prefLabel "has data processor" ; 
    skos:definition "Indiciates inclusion or applicability of a Data Processor" ;
    .

dpv:hasPurpose a rdf:Property ;
    skos:prefLabel "has purpose"@en ;
    skos:definition "Indicates association with Purpose"@en ;
    .

dpv:hasPersonalData a rdf:Property ;
    skos:prefLabel "has personal data" ;
    skos:definition "Indicates association with Personal Data"@en ;
    .

dpv:hasProcessing a rdf:Property ;
    skos:prefLabel "Has processing" ;
    skos:definition "Indicates association with Processing" ;
    .

dpv:hasTechnicalOrganisationalMeasure a rdf:Property ;
    skos:prefLabel "has technical and organisational measure"@en ;
    skos:definition "Indicates use or applicability of Technical or Organisational measure"@en ;
    .


sdc:hasDataHandling a rdf:Property ;
    skos:prefLabel "Has Data Handling" ;
    skos:definition "The property which links a contract to a data handling" ;
    .

sdc:allowedVulnerabilitySeverity a rdf:Property ;
    skos:prefLabel "Allowed vulnerability severity" ;
    skos:definition "A list of the accepted vulnerability severity levels in a container image, such as Low, Medium or High" ;
    .

sdc:maxAge a rdf:Property ;
    skos:prefLabel "Maximum age" ;
    skos:definition "Indicates how old something is allowed to be" ;
    .

###################################################################################################################
sdc:hasIdentifierShape a sh:PropertyShape ;
    sh:path dpv:hasIdentifier ;
    skos:prefLabel "Has identifier" ;
    sh:datatype xsd:string ;
    .

sdc:startDateShape a sh:PropertyShape ;
    sh:path dcat:startDate ;
    skos:prefLabel "Has start date" ;
    sh:datatype xsd:dateTime ;
    sh:lessThanOrEquals dcat:endDate ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    .

sdc:endDateShape a sh:PropertyShape ;
    sh:path dcat:endDate ;
    skos:prefLabel "Has end date" ;
    sh:datatype xsd:dateTime ;
    sh:minCount 1 ; 
    sh:maxCount 1 ;
    .

sdc:hasDataHandlingShape a sh:PropertyShape ;
    sh:path sdc:hasDataHandling ;
    sh:class sdc:DataHandling ;
    sh:minCount 1 ;
    .

sdc:hasDataControllerShape a sh:PropertyShape ;
    sh:path dpv:hasDataController ;
    skos:prefLabel "Has Data Controller" ;
    sh:minCount 1 ;
    sh:class dpv:DataController;
    .

sdc:hasDataSubjectShape a sh:PropertyShape ;
    sh:path dpv:hasDataSubject ;
    skos:prefLabel "Has Data Subject" ;
    sh:class dpv:DataSubject
    .

sdc:hasDataProcessorShape a sh:PropertyShape ;
    sh:path dpv:hasDataProcessor ;
    skos:prefLabel "Has Data Processor" ;
    sh:minCount 1 ;
    sh:class dpv:DataProcessor ;
    .

sdc:hasPurposeShape a sh:PropertyShape ;        
    sh:path dpv:hasPurpose ;
    skos:prefLabel "Has purpose" ;
    sh:class dpv:Purpose ; 
    sh:minCount 1 ;
    sh:maxCount 1 ;
    .

sdc:hasPersonalDataShape a sh:PropertyShape ;        
    sh:path dpv:hasPersonalData ;
    skos:prefLabel "Has data" ;
    sh:class dpv:PersonalData ;
    sh:minCount 1 ;
    .

sdc:hasProcessingShape a sh:PropertyShape ;        
    sh:path dpv:hasProcessing ;
    skos:prefLabel "Has processing" ;
    sh:class dpv:Processing ;
    sh:minCount 1 ;
    .

sdc:hasTechnicalOrganisationalMeasureShape a sh:PropertyShape ;        
    sh:path dpv:hasTechnicalOrganisationalMeasure ;
    skos:prefLabel "Has measure" ;
    sh:minCount 1 ;
    sh:or ([sh:class dpv:TechnicalMeasure][sh:class dpv:OrganisationalMeasure])
    .


sdc:nameShape a sh:PropertyShape ;
    sh:path dpv:hasName ;
    sh:datatype xsd:string ;
    .

sdc:identifierShape a sh:PropertyShape ;
    sh:path dpv:hasIdentifier ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    .

sdc:downloadURLShape a sh:PropertyShape ;
    sh:path dcat:downloadURL ;
    sh:minCount 1 ;
    skos:prefLabel "Download URL" ;
    sh:datatype xsd:string ;
    .

sdc:themeShape a sh:PropertyShape ;
    sh:path dcat:theme ;
    sh:minCount 1 ;
    skos:prefLabel "Theme" ;
    sh:class sdc:Theme ;
    .

######DO WE STILL NEED THESE? ################################################################################

# sdc:SecurityScanConstraint a rdfs:Class ;
#     skos:prefLabel "Security scan constraint" ;
#     skos:definition "An object which indicates the constraints on a security scan report" ;
#     .


# sdc:SecurityScanConstraintShape a sh:NodeShape ;
#     sh:targetClass sdc:SecurityScanConstraint ;
#     sh:property [
#         sh:path sdc:allowedVulnerabilitySeverity ;
#         sh:node shsh:ListShape ;
#     ],
#     [
#         sh:path sdc:maxAge ;
#         sh:minCount 1 ;
#         sh:datatype xsd:duration ;
#     ].

# shsh:ListShape
# 	a sh:NodeShape ;
# 	skos:prefLabel "List shape"@en ;
# 	skos:definition "A shape describing well-formed RDF lists. Currently does not check for non-recursion. This could be expressed using SHACL-SPARQL."@en ;
# 	rdfs:seeAlso <https://www.w3.org/TR/shacl/#syntax-rule-SHACL-list> ;
# 	sh:property [
# 		sh:path [ sh:zeroOrMorePath rdf:rest ] ;
# 		skos:definition "Each list member (including this node) must have the shape shsh:ListNodeShape."@en ;
# 		sh:hasValue rdf:nil ;
# 		sh:node shsh:ListNodeShape ;
# 	] .

# shsh:ListNodeShape
# 	a sh:NodeShape ;
# 	skos:prefLabel "List node shape"@en ;
# 	skos:definition "Defines constraints on what it means for a node to be a node within a well-formed RDF list. Note that this does not check whether the rdf:rest items are also well-formed lists as this would lead to unsupported recursion."@en ;
# 	sh:or ( [
# 				sh:hasValue rdf:nil ;
#         		sh:property [
# 					sh:path rdf:first ;
# 					sh:maxCount 0 ;
# 				] ;
# 				sh:property [
# 					sh:path rdf:rest ;
# 					sh:maxCount 0 ;
# 				] ;
# 			]
# 			[
# 				sh:not [ sh:hasValue rdf:nil ] ;
# 				sh:property [
# 					sh:path rdf:first ;
# 					sh:maxCount 1 ;
# 					sh:minCount 1 ;
# 				] ;
# 				sh:property [
# 					sh:path rdf:rest ;
# 					sh:maxCount 1 ;
# 					sh:minCount 1 ;
# 				] ;
# 			] ) .